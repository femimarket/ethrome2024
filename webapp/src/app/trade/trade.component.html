<div class="trading-view">
    <header>
      <div class="pair-selector">
        <mat-form-field>
          <mat-label>Select trading pair</mat-label>
          <mat-select [(value)]="selectedPair" (selectionChange)="onPairChange($event.value)">
            <mat-option value="BTC/USD">BTC/USD</mat-option>
            <mat-option value="ETH/USD">ETH/USD</mat-option>
            <mat-option value="XRP/USD">XRP/USD</mat-option>
          </mat-select>
        </mat-form-field>
        <h1>{{selectedPair}}</h1>
      </div>
      <div class="current-price">
        <span class="price">{{currentPrices[selectedPair].price | number:'1.2-2'}}</span>
        <span class="change" [ngClass]="{'positive': currentPrices[selectedPair].change >= 0, 'negative': currentPrices[selectedPair].change < 0}">
          <mat-icon>{{currentPrices[selectedPair].change >= 0 ? 'arrow_upward' : 'arrow_downward'}}</mat-icon>
          {{currentPrices[selectedPair].change | number:'1.2-2'}}%
        </span>
      </div>
    </header>
  
    <div class="main-content">
      <div class="chart-and-history">
        <div class="chart">
          <!-- Placeholder for chart. You would typically use a charting library here -->
          <p>Chart placeholder</p>
        </div>
        <div class="trading-history">
          <h2>Trading History</h2>
          <table mat-table [dataSource]="tradingHistoryData[selectedPair]">
            <ng-container matColumnDef="time">
              <th mat-header-cell *matHeaderCellDef>Time</th>
              <td mat-cell *matCellDef="let trade">{{trade.time}}</td>
            </ng-container>
            <ng-container matColumnDef="price">
              <th mat-header-cell *matHeaderCellDef>Price</th>
              <td mat-cell *matCellDef="let trade">{{trade.price | number:'1.4-4'}}</td>
            </ng-container>
            <ng-container matColumnDef="amount">
              <th mat-header-cell *matHeaderCellDef>Amount</th>
              <td mat-cell *matCellDef="let trade">{{trade.amount}}</td>
            </ng-container>
            <ng-container matColumnDef="type">
              <th mat-header-cell *matHeaderCellDef>Type</th>
              <td mat-cell *matCellDef="let trade" [ngClass]="trade.type">
                {{trade.type | titlecase}}
              </td>
            </ng-container>
  
            <tr mat-header-row *matHeaderRowDef="['time', 'price', 'amount', 'type']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['time', 'price', 'amount', 'type'];"></tr>
          </table>
        </div>
      </div>
  
      <div class="sidebar">
        <div class="order-book">
          <h2>Order Book</h2>
          <div class="book-content">
            <div class="bids">
              <h3>Bids</h3>
              <div *ngFor="let bid of orderBookData[selectedPair].bids">
                <span>{{bid.price | number:'1.2-2'}}</span>
                <span>{{bid.amount | number:'1.2-2'}}</span>
              </div>
            </div>
            <div class="asks">
              <h3>Asks</h3>
              <div *ngFor="let ask of orderBookData[selectedPair].asks">
                <span>{{ask.price | number:'1.2-2'}}</span>
                <span>{{ask.amount | number:'1.2-2'}}</span>
              </div>
            </div>
          </div>
        </div>
  
        <div class="order-form">
          <h2>Place Order</h2>
          <mat-tab-group (selectedTabChange)="onOrderTypeChange($event.tab.textLabel.toLowerCase())">
            <mat-tab label="Market">
              <form [formGroup]="orderForm" (ngSubmit)="placeOrder()">
                <mat-button-toggle-group [(ngModel)]="side" [ngModelOptions]="{standalone: true}">
                  <mat-button-toggle value="buy">Buy</mat-button-toggle>
                  <mat-button-toggle value="sell">Sell</mat-button-toggle>
                </mat-button-toggle-group>
                <mat-form-field>
                  <mat-label>Amount ({{selectedPair.split('/')[0]}})</mat-label>
                  <input matInput type="number" formControlName="amount">
                </mat-form-field>
                <button mat-raised-button color="primary" type="submit">Place Market Order</button>
              </form>
            </mat-tab>
            <mat-tab label="Limit">
              <form [formGroup]="orderForm" (ngSubmit)="placeOrder()">
                <mat-button-toggle-group [(ngModel)]="side" [ngModelOptions]="{standalone: true}">
                  <mat-button-toggle value="buy">Buy</mat-button-toggle>
                  <mat-button-toggle value="sell">Sell</mat-button-toggle>
                </mat-button-toggle-group>
                <mat-form-field>
                  <mat-label>Price ({{selectedPair.split('/')[1]}})</mat-label>
                  <input matInput type="number" formControlName="price">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>Amount ({{selectedPair.split('/')[0]}})</mat-label>
                  <input matInput type="number" formControlName="amount">
                </mat-form-field>
                <button mat-raised-button color="primary" type="submit">Place Limit Order</button>
              </form>
            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    </div>
  </div>